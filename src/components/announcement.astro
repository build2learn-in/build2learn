---
import { getCollection } from 'astro:content';

const events = await getCollection('event');
const currentDate = new Date();

const upcomingEvent = events
  .map((event: any) => ({
    ...event,
    eventDate: new Date(event.data.eventDate)
  }))
  .filter((event: any) => event.eventDate >= currentDate)
  .sort((a: any, b: any) => a.eventDate.getTime() - b.eventDate.getTime())[0];

const formatEventDate = (date: Date) => {
  return date.toLocaleDateString('en-US', {
    weekday: 'long',
    month: 'long',
    day: 'numeric'
  });
};
---

{upcomingEvent && (
<!-- Event Banner -->
<section class="bg-yellow-100 text-gray-900 py-4 px-4 sm:px-6 lg:px-8 border-b border-yellow-300">
<div class="container mx-auto flex flex-col md:flex-row items-center justify-between gap-4 text-center md:text-left">
	<div>
	<p class="text-lg font-semibold">
		ğŸ‰ {upcomingEvent.data.title} Meetup - <span class="text-primary font-bold">{formatEventDate(upcomingEvent.eventDate)}</span>
	</p>
	<p class="text-sm text-gray-700">
		â° {upcomingEvent.data.eventTime} IST | ğŸ“ {upcomingEvent.data.venue}
	</p>
	</div>
	{upcomingEvent.data.registration_link && (
	<a
	href={upcomingEvent.data.registration_link}
	target="_blank"
	class="inline-block bg-primary text-white font-semibold px-6 py-2 rounded-lg shadow-md hover:bg-primary-dark transition"
	>
	Register Now â†’
	</a>
	)}
</div>
</section>
)}